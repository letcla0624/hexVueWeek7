"use strict";(self["webpackChunkhexVueWeek7"]=self["webpackChunkhexVueWeek7"]||[]).push([[589],{422:function(e,t,a){function s(e){return{all:e=e||new Map,on:function(t,a){var s=e.get(t);s?s.push(a):e.set(t,[a])},off:function(t,a){var s=e.get(t);s&&(a?s.splice(s.indexOf(a)>>>0,1):e.set(t,[]))},emit:function(t,a){var s=e.get(t);s&&s.slice().map((function(e){e(a)})),(s=e.get("*"))&&s.slice().map((function(e){e(t,a)}))}}}a.d(t,{Z:function(){return r}});const l=s();var r=l},7476:function(e,t,a){a.d(t,{Z:function(){return m}});var s=a(3396),l=a(7139);const r={style:{"--bs-breadcrumb-divider":"'>'"},"aria-label":"breadcrumb"},o={class:"breadcrumb mb-5"},i=["onClick"];function n(e,t,a,n,d,c){return(0,s.wg)(),(0,s.iD)("nav",r,[(0,s._)("ol",o,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(d.breadcrumbList,((e,t)=>((0,s.wg)(),(0,s.iD)("li",{key:t+`_${e}`,class:"breadcrumb-item",onClick:e=>c.routeTo(t)},(0,l.zw)(e.name),9,i)))),128))])])}var d={data(){return{breadcrumbList:[]}},watch:{$route(){this.nowBreadcrumb()}},methods:{nowBreadcrumb(){this.breadcrumbList=this.$route.meta.breadcrumb},routeTo(e){this.breadcrumbList[e].link&&this.$router.push(this.breadcrumbList[e].link)}},mounted(){this.nowBreadcrumb()}},c=a(89);const u=(0,c.Z)(d,[["render",n]]);var m=u},7589:function(e,t,a){a.r(t),a.d(t,{default:function(){return oe}});var s=a(3396),l=a(7139),r=a(9242);const o={class:"container"},i=(0,s._)("h1",{class:"text-center py-3"},"購物車",-1),n={class:"row g-5 g-lg-3"},d={class:"col-lg-6"},c=(0,s._)("h2",{class:"h3 text-center mb-5"},"購物清單",-1),u={class:"table-responsive"},m={class:"table"},h=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",{scope:"col"},"#"),(0,s._)("th",{scope:"col"},"名稱"),(0,s._)("th",{scope:"col"},"單價"),(0,s._)("th",{scope:"col",style:{"min-width":"90px"}},"數量/單位"),(0,s._)("th",{scope:"col",class:"text-end"},"價格")])],-1),p={scope:"row"},b=["onClick"],g={key:0,class:"spinner-border spinner-border-sm",role:"status"},f=(0,s._)("span",{class:"visually-hidden"},"Loading...",-1),_=[f],v={key:1,class:"bi bi-trash-fill"},w={class:"input-group input-group-sm"},k=["onUpdate:modelValue","onChange","disabled"],y=["value"],x={class:"text-end"},C=(0,s._)("td",{colspan:"4",class:"text-end"},"總價",-1),$={class:"fw-bold text-danger d-flex justify-content-end align-items-center"},V=(0,s.Uk)(" $NTD"),L={class:"fs-4 ms-1"},U={class:"d-grid gap-3 d-sm-flex justify-content-sm-end mt-3"},D=(0,s._)("i",{class:"bi bi-cart-fill me-1"},null,-1),W=(0,s.Uk)("繼續購物"),q=["disabled"],z={key:0,class:"spinner-border spinner-border-sm",role:"status"},Z=(0,s._)("span",{class:"visually-hidden"},"Loading...",-1),B=[Z],T={key:1,class:"bi bi-trash-fill me-1"},F=(0,s.Uk)(" 清空購物車 "),H={class:"col-lg-6"},K={class:"border border-dark py-5 px-3 p-md-5 rounded-3"},M=(0,s._)("h2",{class:"h3 text-center mb-5"},"訂購資訊",-1),N={class:"form-floating mb-3"},O=(0,s._)("label",{for:"email"},[(0,s._)("span",{class:"text-danger me-1"},"*"),(0,s.Uk)("訂購者信箱")],-1),Y={class:"form-floating mb-3"},j=(0,s._)("label",{for:"name"},[(0,s._)("span",{class:"text-danger me-1"},"*"),(0,s.Uk)("收件人姓名")],-1),I={class:"form-floating mb-3"},P=(0,s._)("label",{for:"tel"},[(0,s._)("span",{class:"text-danger me-1"},"*"),(0,s.Uk)("收件人手機號")],-1),S={class:"form-floating mb-3"},E=(0,s._)("label",{for:"tel"},[(0,s._)("span",{class:"text-danger me-1"},"*"),(0,s.Uk)("收件人地址")],-1),A={class:"form-floating mb-3"},G=(0,s._)("label",{for:"message"},"留言",-1),J=["disabled"],Q=(0,s._)("i",{class:"bi bi-credit-card-fill me-1"},null,-1),R=(0,s.Uk)(" 送出訂單，並結帳 "),X=[Q,R];function ee(e,t,a,f,Z,Q){const R=(0,s.up)("BreadComponent"),ee=(0,s.up)("router-link"),te=(0,s.up)("VField"),ae=(0,s.up)("ErrorMessage"),se=(0,s.up)("VForm");return(0,s.wg)(),(0,s.iD)("div",o,[i,(0,s.Wm)(R),(0,s._)("div",n,[(0,s._)("div",d,[c,(0,s._)("div",u,[(0,s._)("table",m,[h,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(Z.cart.carts,(e=>((0,s.wg)(),(0,s.iD)("tr",{key:e.id},[(0,s._)("th",p,[(0,s._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:t=>Q.deleteItem(e.id)},[Z.isLoading===e.id?((0,s.wg)(),(0,s.iD)("div",g,_)):((0,s.wg)(),(0,s.iD)("i",v))],8,b)]),(0,s._)("td",null,(0,l.zw)(e.product.title),1),(0,s._)("td",null,"$NTD "+(0,l.zw)(e.product.price),1),(0,s._)("td",null,[(0,s._)("div",w,[(0,s.wy)((0,s._)("select",{class:"form-select form-select-sm","onUpdate:modelValue":t=>e.qty=t,onChange:t=>Q.updateCart(e),disabled:Z.isLoading===e.id},[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)(10,(t=>(0,s._)("option",{key:`${t}${e.product_id}`,value:t},(0,l.zw)(t),9,y))),64))],40,k),[[r.bM,e.qty]]),(0,s._)("span",null,"／"+(0,l.zw)(e.product.unit),1)])]),(0,s._)("td",x,"$NTD "+(0,l.zw)(e.total),1)])))),128))]),(0,s._)("tfoot",null,[(0,s._)("tr",null,[C,(0,s._)("td",$,[V,(0,s._)("b",L,(0,l.zw)(Z.cart.total),1)])])])])]),(0,s._)("div",U,[(0,s.Wm)(ee,{to:"/products",class:"btn btn-outline-dark"},{default:(0,s.w5)((()=>[D,W])),_:1}),(0,s._)("button",{type:"button",class:"btn btn-outline-danger",onClick:t[0]||(t[0]=e=>Q.deleteCarts(Z.cart.carts)),disabled:0===Z.cart.carts.length},[Z.isLoading===Z.cart.carts?((0,s.wg)(),(0,s.iD)("div",z,B)):((0,s.wg)(),(0,s.iD)("i",T)),F],8,q)])]),(0,s._)("div",H,[(0,s._)("div",K,[M,(0,s.Wm)(se,{ref:"form",onSubmit:Q.sentOrder},{default:(0,s.w5)((({errors:e})=>[(0,s._)("div",N,[(0,s.Wm)(te,{type:"email",name:"訂購者信箱",class:(0,l.C_)(["form-control border-0 border-bottom rounded-0",{"is-invalid":e["訂購者信箱"]}]),id:"email",placeholder:"name@example.com",rules:"email|required",modelValue:Z.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=e=>Z.form.user.email=e)},null,8,["class","modelValue"]),(0,s.Wm)(ae,{name:"訂購者信箱",class:"invalid-feedback"}),O]),(0,s._)("div",Y,[(0,s.Wm)(te,{type:"text",name:"收件人姓名",class:(0,l.C_)(["form-control border-0 border-bottom rounded-0",{"is-invalid":e["收件人姓名"]}]),id:"name",placeholder:"收件人姓名",rules:"required",modelValue:Z.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=e=>Z.form.user.name=e)},null,8,["class","modelValue"]),(0,s.Wm)(ae,{name:"收件人姓名",class:"invalid-feedback"}),j]),(0,s._)("div",I,[(0,s.Wm)(te,{type:"tel",name:"收件人手機號",class:(0,l.C_)(["form-control border-0 border-bottom rounded-0",{"is-invalid":e["收件人手機號"]}]),id:"tel",placeholder:"收件人手機號",rules:Q.isPhone,modelValue:Z.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=e=>Z.form.user.tel=e)},null,8,["class","rules","modelValue"]),(0,s.Wm)(ae,{name:"收件人手機號",class:"invalid-feedback"}),P]),(0,s._)("div",S,[(0,s.Wm)(te,{type:"text",name:"收件人地址",class:(0,l.C_)(["form-control border-0 border-bottom rounded-0",{"is-invalid":e["收件人地址"]}]),id:"address",placeholder:"收件人地址",rules:"required",modelValue:Z.form.user.address,"onUpdate:modelValue":t[4]||(t[4]=e=>Z.form.user.address=e)},null,8,["class","modelValue"]),(0,s.Wm)(ae,{name:"收件人地址",class:"invalid-feedback"}),E]),(0,s._)("div",A,[(0,s.wy)((0,s._)("textarea",{class:"form-control border-0 border-bottom rounded-0",placeholder:"留言",id:"message",style:{height:"150px"},"onUpdate:modelValue":t[5]||(t[5]=e=>Z.form.message=e)},null,512),[[r.nr,Z.form.message]]),G]),(0,s._)("button",{type:"submit",class:"btn btn-warning w-100 mt-3",disabled:0===Z.cart.carts.length},X,8,J)])),_:1},8,["onSubmit"])])])])])}var te=a(422),ae=a(7476),se={data(){return{cart:{carts:[]},isLoading:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},components:{BreadComponent:ae.Z},methods:{getCart(){let e=this.$loading.show();this.$http.get("https://vue3-course-api.hexschool.io/v2/api/letcla/cart").then((t=>{e.hide(),this.cart=t.data.data,te.Z.emit("get-cart")})).catch((t=>{e.hide(),console.dir(t)}))},updateCart(e){this.isLoading=e.id;const t={product_id:e.product_id,qty:e.qty};this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/letcla/cart/${e.id}`,{data:t}).then((e=>{alert(e.data.message),this.isLoading="",this.getCart()})).catch((e=>{console.dir(e)}))},deleteItem(e){this.isLoading=e,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/letcla/cart/${e}`).then((e=>{alert(e.data.message),this.isLoading="",this.getCart()})).catch((e=>{console.dir(e)}))},deleteCarts(e){this.isLoading=e,this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/letcla/carts").then((e=>{alert(e.data.message),this.isLoading="",this.getCart()})).catch((e=>{alert(e.response.data.message)}))},isPhone(e){const t=/^(09)[0-9]{8}$/;return!!t.test(e)||"需要正確的電話號碼"},sentOrder(){let e=this.$loading.show();this.$http.post("https://vue3-course-api.hexschool.io/v2/api/letcla/order",{data:this.form}).then((t=>{e.hide(),alert(`${t.data.message}, 訂單編號：${t.data.create_at}, 總金額：${t.data.total}`),this.$refs.form.resetForm(),this.form.message="",this.getCart(),this.$router.push("/pay")})).catch((t=>{e.hide(),alert(t.response.data.message)}))}},mounted(){this.getCart()}},le=a(89);const re=(0,le.Z)(se,[["render",ee]]);var oe=re}}]);
//# sourceMappingURL=589.41b0c15d.js.map
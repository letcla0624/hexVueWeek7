"use strict";(self["webpackChunkhexVueWeek7"]=self["webpackChunkhexVueWeek7"]||[]).push([[268],{4476:function(e,t,o){o.d(t,{Z:function(){return M},_:function(){return k}});var a=o(3396),n=o(7139);const l={class:"modal fade",tabindex:"-1","aria-labelledby":"delModalLabel","aria-hidden":"true",ref:"delModal"},s={class:"modal-dialog modal-dialog-centered"},i={class:"modal-content"},d={class:"modal-header"},p={class:"modal-title",id:"delModalLabel"},r=(0,a._)("i",{class:"bi bi-exclamation-triangle-fill text-danger me-2"},null,-1),c=(0,a.Uk)("熊孩子，您確定要刪除"),u={class:"text-danger mx-1"},m=(0,a.Uk)("嗎？ "),b=(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),h=(0,a._)("div",{class:"modal-body"},"刪除之後資料不可逆，不可反悔喔！",-1),_={class:"modal-footer"},g=(0,a._)("button",{type:"button",class:"btn btn-link text-decoration-none text-secondary","data-bs-dismiss":"modal"}," 取消 ",-1),f=(0,a._)("i",{class:"bi bi-trash-fill me-1"},null,-1),v=(0,a.Uk)("確定刪除 "),C=[f,v];function w(e,t,o,f,v,w){return(0,a.wg)(),(0,a.iD)("div",l,[(0,a._)("div",s,[(0,a._)("div",i,[(0,a._)("div",d,[(0,a._)("h5",p,[r,c,(0,a._)("span",u,(0,n.zw)(o.delItem.title),1),m]),b]),h,(0,a._)("div",_,[g,(0,a._)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=e=>w.delProdBtn(o.delItem.id))},C)])])])],512)}let k=null;var y={props:["delItem","pageName"],methods:{delProdBtn(e){let t="";"prodsList"===this.pageName?t=`https://vue3-course-api.hexschool.io/v2/api/letcla/admin/product/${e}`:"orders"===this.pageName?t=`https://vue3-course-api.hexschool.io/v2/api/letcla/admin/order/${e}`:"coupons"===this.pageName&&(t=`https://vue3-course-api.hexschool.io/v2/api/letcla/admin/coupon/${e}`),this.$http.delete(t).then((e=>{this.$emit("get-item"),k.hide(),setTimeout((()=>{alert(e.data.message)}),1e3)})).catch((e=>{console.dir(e.response),k.hide(),alert(e.response.data.message)}))}},mounted(){k=new bootstrap.Modal(this.$refs.delModal,{backdrop:"static",keyboard:!1})}},x=o(89);const N=(0,x.Z)(y,[["render",w]]);var M=N},630:function(e,t,o){o.d(t,{Z:function(){return g}});var a=o(3396),n=o(7139),l=o(9242);const s={class:"my-5","aria-label":"Page navigation"},i={class:"pagination justify-content-center"},d=(0,a._)("span",{"aria-hidden":"true"},[(0,a._)("i",{class:"bi bi-chevron-left"})],-1),p=[d],r=["onClick"],c=(0,a._)("span",{"aria-hidden":"true"},[(0,a._)("i",{class:"bi bi-chevron-right"})],-1),u=[c];function m(e,t,o,d,c,m){return(0,a.wg)(),(0,a.iD)("nav",s,[(0,a._)("ul",i,[(0,a._)("li",{class:(0,n.C_)(["page-item",{disabled:1===o.pages.current_page}])},[(0,a._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,l.iM)((e=>m.emitPage(o.pages.current_page-1)),["prevent"]))},p)],2),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.pages.total_pages,((e,t)=>((0,a.wg)(),(0,a.iD)("li",{class:(0,n.C_)(["page-item",{active:e===o.pages.current_page}]),key:t},[(0,a._)("a",{class:"page-link",href:"#",onClick:(0,l.iM)((t=>m.emitPage(e)),["prevent"])},(0,n.zw)(e),9,r)],2)))),128)),(0,a._)("li",{class:(0,n.C_)(["page-item",{disabled:o.pages.current_page===o.pages.total_pages}])},[(0,a._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,l.iM)((e=>m.emitPage(o.pages.current_page+1)),["prevent"]))},u)],2)])])}var b={props:["pages"],methods:{emitPage(e){this.$emit("emit-page",e)}}},h=o(89);const _=(0,h.Z)(b,[["render",m]]);var g=_},9268:function(e,t,o){o.r(t),o.d(t,{default:function(){return te}});var a=o(3396),n=o(7139);const l={class:"container"},s=(0,a._)("h1",{class:"text-center py-3"},"優惠券",-1),i={class:"text-end mb-3"},d=(0,a._)("i",{class:"bi bi-pencil-square me-1"},null,-1),p=(0,a.Uk)(" 新增優惠券 "),r=[d,p],c={class:"table-responsive"},u={class:"table table-dark table-hover"},m=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"標題"),(0,a._)("th",null,"折扣百分比"),(0,a._)("th",null,"到期日"),(0,a._)("th",null,"是否啟用"),(0,a._)("th",null,"編輯／刪除")])],-1),b={key:0,"true-value":1,"false-value":0,class:"text-success"},h={key:1,class:"text-muted"},_={class:"btn-group"},g=["onClick"],f=(0,a._)("i",{class:"bi bi-pencil-fill"},null,-1),v=[f],C=["onClick"],w=(0,a._)("i",{class:"bi bi-trash-fill"},null,-1),k=[w];function y(e,t,o,d,p,f){const w=(0,a.up)("PageComponent"),y=(0,a.up)("CreateCouponComponent"),x=(0,a.up)("DeleteComponent");return(0,a.wg)(),(0,a.iD)("div",l,[s,(0,a._)("div",i,[(0,a._)("button",{type:"button",class:"btn btn-dark ms-3",onClick:t[0]||(t[0]=e=>f.openModal("new"))},r)]),(0,a._)("div",c,[(0,a._)("table",u,[m,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(p.coupons,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",null,(0,n.zw)(e.title),1),(0,a._)("td",null,(0,n.zw)(e.percent)+"%",1),(0,a._)("td",null,(0,n.zw)(new Date(1e3*e.due_date).toLocaleDateString()),1),(0,a._)("td",null,[e.is_enabled?((0,a.wg)(),(0,a.iD)("span",b,"啟用")):((0,a.wg)(),(0,a.iD)("span",h,"未啟用"))]),(0,a._)("td",null,[(0,a._)("div",_,[(0,a._)("button",{class:"btn btn-outline-warning btn-sm",onClick:t=>f.openModal("edit",e)},v,8,g),(0,a._)("button",{class:"btn btn-outline-danger btn-sm",onClick:t=>f.openModal("delete",e)},k,8,C)])])])))),128))])])]),(0,a.Wm)(w,{pages:p.pagination,onEmitPage:f.getCoupons},null,8,["pages","onEmitPage"]),(0,a.Wm)(y,{coupon:p.tempCoupon,"is-new":p.isNew,onUpdateCoupons:f.getCoupons},null,8,["coupon","is-new","onUpdateCoupons"]),(0,a.Wm)(x,{"del-item":p.tempCoupon,"page-name":p.pageName,onGetItem:f.getCoupons},null,8,["del-item","page-name","onGetItem"])])}var x=o(630),N=o(9242);const M={class:"modal fade",tabindex:"-1","aria-labelledby":"couponModalLabel","aria-hidden":"true",ref:"couponModal"},D={class:"modal-dialog modal-dialog-centered"},$={class:"modal-content"},P={class:"modal-header"},U={class:"modal-title",id:"couponModalLabel"},z=(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Z={class:"modal-body"},V={class:"form-floating mb-3"},L=(0,a._)("label",{for:"floatingTitle"},"標題",-1),B={class:"form-floating mb-3"},I=(0,a._)("label",{for:"floatingCode"},"折扣碼",-1),W={class:"form-floating mb-3"},T=(0,a._)("label",{for:"floatingDate"},"到期日 (點選 icon)",-1),E={class:"form-floating mb-3"},G=(0,a._)("label",{for:"floatingPrice"},"折扣百分比 (%)",-1),H={class:"mb-3"},K={class:"form-check"},Y={class:"form-check-label",for:"is_enabled"},j={class:"modal-footer"},q=(0,a._)("button",{type:"button",class:"btn btn-link text-decoration-none text-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function S(e,t,o,l,s,i){return(0,a.wg)(),(0,a.iD)("div",M,[(0,a._)("div",D,[(0,a._)("div",$,[(0,a._)("div",P,[(0,a._)("h5",U,(0,n.zw)(o.isNew?"新增優惠券":"編輯優惠券"),1),z]),(0,a._)("div",Z,[(0,a._)("div",V,[(0,a.wy)((0,a._)("input",{type:"text",class:"form-control border-0 border-bottom rounded-0",id:"floatingTitle",placeholder:"請輸入標題","onUpdate:modelValue":t[0]||(t[0]=e=>s.tempCoupon.title=e)},null,512),[[N.nr,s.tempCoupon.title]]),L]),(0,a._)("div",B,[(0,a.wy)((0,a._)("input",{type:"text",class:"form-control border-0 border-bottom rounded-0",id:"floatingCode",placeholder:"請輸入折扣碼","onUpdate:modelValue":t[1]||(t[1]=e=>s.tempCoupon.code=e)},null,512),[[N.nr,s.tempCoupon.code]]),I]),(0,a._)("div",W,[(0,a.wy)((0,a._)("input",{type:"date",class:"form-control border-0 border-bottom rounded-0",id:"floatingDate","onUpdate:modelValue":t[2]||(t[2]=e=>s.due_date=e)},null,512),[[N.nr,s.due_date]]),T]),(0,a._)("div",E,[(0,a.wy)((0,a._)("input",{type:"number",class:"form-control border-0 border-bottom rounded-0",id:"floatingPrice",min:"0",placeholder:"請輸入折扣百分比","onUpdate:modelValue":t[3]||(t[3]=e=>s.tempCoupon.percent=e)},null,512),[[N.nr,s.tempCoupon.percent,void 0,{number:!0}]]),G]),(0,a._)("div",H,[(0,a._)("div",K,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox",id:"is_enabled","onUpdate:modelValue":t[4]||(t[4]=e=>s.tempCoupon.is_enabled=e),"true-value":1,"false-value":0},null,512),[[N.e8,s.tempCoupon.is_enabled]]),(0,a._)("label",Y,(0,n.zw)(s.tempCoupon.is_enabled?"啟用":"不啟用 "),1)])])]),(0,a._)("div",j,[q,(0,a._)("button",{type:"button",class:(0,n.C_)(["btn",[{"btn-dark":o.isNew},{"btn-warning":!o.isNew}]]),onClick:t[5]||(t[5]=(...e)=>i.upCouponBtn&&i.upCouponBtn(...e))},[(0,a._)("i",{class:(0,n.C_)(["bi me-2",[{"bi-check-lg":o.isNew},{"bi-check-all":!o.isNew}]])},null,2),(0,a.Uk)((0,n.zw)(o.isNew?"確定新增":"確定修改"),1)],2)])])])],512)}let A=null;var F={props:["coupon","isNew"],data(){return{tempCoupon:{},due_date:""}},watch:{coupon(){this.tempCoupon=this.coupon},due_date(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}},methods:{upCouponBtn(){let e=this.$loading.show(),t="https://vue3-course-api.hexschool.io/v2/api/letcla/admin/coupon",o="post";this.isNew||(t=`https://vue3-course-api.hexschool.io/v2/api/letcla/admin/coupon/${this.coupon.id}`,o="put"),this.$http[o](t,{data:this.coupon}).then((t=>{e.hide(),this.$emit("update-coupons"),A.hide(),setTimeout((()=>{alert(t.data.message)}),1e3)})).catch((t=>{e.hide(),console.dir(t.response),alert(t.response.data.message)}))}},mounted(){A=new bootstrap.Modal(this.$refs.couponModal,{backdrop:"static",keyboard:!1})}},J=o(89);const O=(0,J.Z)(F,[["render",S]]);var Q=O,R=o(4476),X={data(){return{coupons:{is_enabled:!1},tempCoupon:{is_enabled:!1},pageName:"coupons",pagination:{},isNew:!0}},components:{PageComponent:x.Z,CreateCouponComponent:Q,DeleteComponent:R.Z},methods:{getCoupons(e=1){let t=this.$loading.show();this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/letcla/admin/coupons?page=${e}`).then((e=>{t.hide(),this.coupons=e.data.coupons,this.pagination=e.data.pagination})).catch((e=>{console.dir(e.response),t.hide()}))},openModal(e,t){"new"===e?(this.isNew=!0,this.tempCoupon={},A.show()):"edit"===e?(this.isNew=!1,this.tempCoupon={...t},this.isNew=!1,A.show()):"delete"===e&&(this.isNew=!1,this.tempCoupon={...t},this.isNew=!1,R._.show())}},mounted(){this.getCoupons()}};const ee=(0,J.Z)(X,[["render",y]]);var te=ee}}]);
//# sourceMappingURL=268.0f84aed9.js.map
"use strict";(self["webpackChunkhexVueWeek7"]=self["webpackChunkhexVueWeek7"]||[]).push([[794],{4476:function(e,t,a){a.d(t,{Z:function(){return C},_:function(){return f}});var l=a(3396),s=a(7139);const n={class:"modal fade",tabindex:"-1","aria-labelledby":"delModalLabel","aria-hidden":"true",ref:"delModal"},i={class:"modal-dialog modal-dialog-centered"},d={class:"modal-content"},o={class:"modal-header"},r={class:"modal-title",id:"delModalLabel"},c=(0,l._)("i",{class:"bi bi-exclamation-triangle-fill text-danger me-2"},null,-1),u=(0,l.Uk)("熊孩子，您確定要刪除"),p={class:"text-danger mx-1"},m=(0,l.Uk)("嗎？ "),_=(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),h=(0,l._)("div",{class:"modal-body"},"刪除之後資料不可逆，不可反悔喔！",-1),b={class:"modal-footer"},g=(0,l._)("button",{type:"button",class:"btn btn-link text-decoration-none text-secondary","data-bs-dismiss":"modal"}," 取消 ",-1),v=(0,l._)("i",{class:"bi bi-trash-fill me-1"},null,-1),w=(0,l.Uk)("確定刪除 "),k=[v,w];function y(e,t,a,v,w,y){return(0,l.wg)(),(0,l.iD)("div",n,[(0,l._)("div",i,[(0,l._)("div",d,[(0,l._)("div",o,[(0,l._)("h5",r,[c,u,(0,l._)("span",p,(0,s.zw)(a.delItem.title),1),m]),_]),h,(0,l._)("div",b,[g,(0,l._)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=e=>y.delProdBtn(a.delItem.id))},k)])])])],512)}let f=null;var O={props:["delItem","pageName"],methods:{delProdBtn(e){let t="";"prodsList"===this.pageName?t=`https://vue3-course-api.hexschool.io/v2/api/letcla/admin/product/${e}`:"orders"===this.pageName?t=`https://vue3-course-api.hexschool.io/v2/api/letcla/admin/order/${e}`:"coupons"===this.pageName&&(t=`https://vue3-course-api.hexschool.io/v2/api/letcla/admin/coupon/${e}`),this.$http.delete(t).then((e=>{this.$emit("get-item"),f.hide(),setTimeout((()=>{alert(e.data.message)}),1e3)})).catch((e=>{console.dir(e.response),f.hide(),alert(e.response.data.message)}))}},mounted(){f=new bootstrap.Modal(this.$refs.delModal,{backdrop:"static",keyboard:!1})}},x=a(89);const D=(0,x.Z)(O,[["render",y]]);var C=D},630:function(e,t,a){a.d(t,{Z:function(){return g}});var l=a(3396),s=a(7139),n=a(9242);const i={class:"my-5","aria-label":"Page navigation"},d={class:"pagination justify-content-center"},o=(0,l._)("span",{"aria-hidden":"true"},[(0,l._)("i",{class:"bi bi-chevron-left"})],-1),r=[o],c=["onClick"],u=(0,l._)("span",{"aria-hidden":"true"},[(0,l._)("i",{class:"bi bi-chevron-right"})],-1),p=[u];function m(e,t,a,o,u,m){return(0,l.wg)(),(0,l.iD)("nav",i,[(0,l._)("ul",d,[(0,l._)("li",{class:(0,s.C_)(["page-item",{disabled:1===a.pages.current_page}])},[(0,l._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,n.iM)((e=>m.emitPage(a.pages.current_page-1)),["prevent"]))},r)],2),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.pages.total_pages,((e,t)=>((0,l.wg)(),(0,l.iD)("li",{class:(0,s.C_)(["page-item",{active:e===a.pages.current_page}]),key:t},[(0,l._)("a",{class:"page-link",href:"#",onClick:(0,n.iM)((t=>m.emitPage(e)),["prevent"])},(0,s.zw)(e),9,c)],2)))),128)),(0,l._)("li",{class:(0,s.C_)(["page-item",{disabled:a.pages.current_page===a.pages.total_pages}])},[(0,l._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,n.iM)((e=>m.emitPage(a.pages.current_page+1)),["prevent"]))},p)],2)])])}var _={props:["pages"],methods:{emitPage(e){this.$emit("emit-page",e)}}},h=a(89);const b=(0,h.Z)(_,[["render",m]]);var g=b},7794:function(e,t,a){a.r(t),a.d(t,{default:function(){return ie}});var l=a(3396),s=a(7139);const n={class:"container"},i=(0,l._)("h1",{class:"text-center py-3"},"顧客訂單",-1),d={class:"table-responsive"},o={class:"table table-dark table-hover"},r=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"訂單日期"),(0,l._)("th",null,"姓名"),(0,l._)("th",null,"購買項目"),(0,l._)("th",null,"應收帳款"),(0,l._)("th",null,"已付款"),(0,l._)("th",null,"編輯／刪除")])],-1),c={class:"list-unstyled"},u={key:0,class:"mb-0 text-success"},p=(0,l._)("i",{class:"bi bi-check-circle-fill me-1"},null,-1),m=(0,l.Uk)("已付款 "),_=[p,m],h={key:1,class:"mb-0"},b={class:"btn-group",role:"group"},g=["onClick"],v=(0,l._)("i",{class:"bi bi-pencil-fill"},null,-1),w=[v],k=["onClick"],y=(0,l._)("i",{class:"bi bi-trash-fill"},null,-1),f=[y];function O(e,t,a,p,m,v){const y=(0,l.up)("PageComponent"),O=(0,l.up)("EditOrderComponent"),x=(0,l.up)("DeleteComponent");return(0,l.wg)(),(0,l.iD)("div",n,[i,(0,l._)("div",d,[(0,l._)("table",o,[r,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.orders,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id},[(0,l._)("td",null,(0,s.zw)(new Date(1e3*e.create_at).toLocaleDateString()),1),(0,l._)("td",null,(0,s.zw)(e.user.name),1),(0,l._)("td",null,[(0,l._)("ul",c,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.products,(e=>((0,l.wg)(),(0,l.iD)("li",{key:e.id},(0,s.zw)(e.product.title)+"／數量："+(0,s.zw)(e.qty)+" "+(0,s.zw)(e.product.unit),1)))),128))])]),(0,l._)("td",null,"$NTD "+(0,s.zw)(e.total),1),(0,l._)("td",null,[!0===e.is_paid?((0,l.wg)(),(0,l.iD)("p",u,_)):((0,l.wg)(),(0,l.iD)("p",h,"未付款"))]),(0,l._)("td",null,[(0,l._)("div",b,[(0,l._)("button",{type:"button",class:"btn btn-outline-warning btn-sm",onClick:t=>v.openModal("edit",e)},w,8,g),(0,l._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:t=>v.openModal("delete",e)},f,8,k)])])])))),128))])])]),(0,l.Wm)(y,{pages:m.pagination,onEmitPage:v.getOrders},null,8,["pages","onEmitPage"]),(0,l.Wm)(O,{order:m.tempOrder,onUpdatePay:v.getOrders},null,8,["order","onUpdatePay"]),(0,l.Wm)(x,{"del-item":m.tempOrder,"page-name":m.pageName,onGetItem:v.getOrders},null,8,["del-item","page-name","onGetItem"])])}var x=a(630),D=a(9242);const C={class:"modal fade",tabindex:"-1","aria-labelledby":"orderModalLabel","aria-hidden":"true",ref:"orderModal"},z={class:"modal-dialog modal-dialog-centered"},$={class:"modal-content"},M=(0,l._)("div",{class:"modal-header"},[(0,l._)("h5",{class:"modal-title",id:"orderModalLabel"},"訂單內容"),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),P={class:"modal-body"},N={class:"row"},U={class:""},Z=(0,l._)("h5",null,"訂購人資料",-1),L={class:"list-unstyled"},T={class:""},E=(0,l._)("h5",null,"訂單資訊",-1),I={class:"list-unstyled"},W=(0,l.Uk)(" 付款狀態： "),H={key:0,class:"text-success"},K={key:1,class:"text-danger"},Y=(0,l.Uk)(" 訂購項目： "),V={class:"table table-responsive"},q=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"商品"),(0,l._)("th",null,"數量"),(0,l._)("th",{class:"text-end"},"價格")])],-1),B={class:"text-end"},G={colspan:"3",class:"text-end"},S=(0,l.Uk)(" 總金額："),j={class:"form-check my-5"},A={class:"form-check-label",for:"is_pay"},F={class:"modal-footer"},J=(0,l._)("button",{type:"button",class:"btn btn-link text-decoration-none text-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Q(e,t,a,n,i,d){return(0,l.wg)(),(0,l.iD)("div",C,[(0,l._)("div",z,[(0,l._)("div",$,[M,(0,l._)("div",P,[(0,l._)("div",N,[(0,l._)("div",U,[Z,(0,l._)("ul",L,[(0,l._)("li",null,"訂購人："+(0,s.zw)(i.tempOrder.user?.name),1),(0,l._)("li",null,"訂單 Email："+(0,s.zw)(i.tempOrder.user?.email),1),(0,l._)("li",null,"電話："+(0,s.zw)(i.tempOrder.user?.tel),1),(0,l._)("li",null,"運送地址："+(0,s.zw)(i.tempOrder.user?.address),1),(0,l._)("li",null,"留言："+(0,s.zw)(i.tempOrder.message),1)])]),(0,l._)("div",T,[E,(0,l._)("ul",I,[(0,l._)("li",null,[W,i.tempOrder.is_paid?((0,l.wg)(),(0,l.iD)("b",H,"已付款")):((0,l.wg)(),(0,l.iD)("b",K,"尚未付款"))]),(0,l._)("li",null,"訂單編號："+(0,s.zw)(i.tempOrder.id),1),(0,l._)("li",null," 訂購日期："+(0,s.zw)(new Date(1e3*i.tempOrder.create_at).toLocaleDateString()),1),(0,l._)("li",null,[Y,(0,l._)("table",V,[q,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(i.tempOrder.products,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id},[(0,l._)("td",null,(0,s.zw)(e?.product?.title),1),(0,l._)("td",null,(0,s.zw)(e?.qty)+"／"+(0,s.zw)(e?.product?.unit),1),(0,l._)("td",B,"$NTD "+(0,s.zw)(e?.final_total),1)])))),128))]),(0,l._)("tfoot",null,[(0,l._)("tr",null,[(0,l._)("td",G,[S,(0,l._)("b",null,"$NTD "+(0,s.zw)(i.tempOrder.total),1)])])])])])]),(0,l._)("div",j,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox",id:"is_pay","onUpdate:modelValue":t[0]||(t[0]=e=>i.tempOrder.is_paid=e)},null,512),[[D.e8,i.tempOrder.is_paid]]),(0,l._)("label",A,(0,s.zw)(i.tempOrder.is_paid?"已付款":"尚未付款 "),1)])])])]),(0,l._)("div",F,[J,(0,l._)("button",{type:"button",class:"btn btn-warning",onClick:t[1]||(t[1]=e=>d.updatePay(i.tempOrder))}," 修改付款狀態 ")])])])],512)}let R=null;var X={props:["order"],data(){return{tempOrder:{products:{},user:{}}}},watch:{order(){this.tempOrder=this.order}},methods:{updatePay(e){let t=this.$loading.show();const a={is_paid:e.is_paid};this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/letcla/admin/order/${e.id}`,{data:a}).then((a=>{t.hide(),R.hide(),setTimeout((()=>{alert(a.data.message)}),1e3),this.$emit("update-pay",e)})).catch((e=>{console.dir(e.response),t.hide(),R.hide(),setTimeout((()=>{alert(e.response.data.message)}),1e3)}))}},mounted(){R=new bootstrap.Modal(this.$refs.orderModal,{backdrop:"static",keyboard:!1})}},ee=a(89);const te=(0,ee.Z)(X,[["render",Q]]);var ae=te,le=a(4476),se={data(){return{orders:{},pagination:{},tempOrder:{},pageName:"orders"}},components:{PageComponent:x.Z,EditOrderComponent:ae,DeleteComponent:le.Z},methods:{getOrders(e=1){let t=this.$loading.show();this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/letcla/admin/orders?page=${e}`).then((e=>{t.hide(),this.orders=e.data.orders,this.pagination=e.data.pagination})).catch((e=>{console.dir(e.response),t.hide()}))},openModal(e,t){"edit"===e?(this.tempOrder={...t},R.show()):"delete"===e&&(this.tempOrder={...t},le._.show())}},mounted(){this.getOrders()}};const ne=(0,ee.Z)(se,[["render",O]]);var ie=ne}}]);
//# sourceMappingURL=794.bca97e38.js.map